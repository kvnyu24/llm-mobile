INFO:hybrid_inference:Log level set to: INFO
INFO:hybrid_inference:Set pad_token to eos_token for tokenizer.
INFO:hybrid_inference:Using device: cpu
INFO:hybrid_inference:Loading model: gpt2...
INFO:hybrid_inference:Using float32 for model loading on CPU.
INFO:hybrid_inference:=====================================================
INFO:hybrid_inference:HYBRID INFERENCE - REAL MODEL EXECUTION
INFO:hybrid_inference:=====================================================
INFO:hybrid_inference:Model: gpt2
INFO:hybrid_inference:Device: cpu
INFO:hybrid_inference:Model dimensions: 768d, 12 layers, 12 attention heads
INFO:hybrid_inference:Prompt: "Test memory compression, layer skipping, and token pruning with pruning action"
INFO:hybrid_inference:Max New Tokens: 100
INFO:hybrid_inference:Enabled optimizations:
INFO:hybrid_inference:  - Token Pruning: True
INFO:hybrid_inference:  - Layer Opt (Skip/Compress): False
INFO:hybrid_inference:  - Memory Management (Quant): False
INFO:hybrid_inference:  - Edge-Cloud Partitioning: False (Logic not active)
INFO:hybrid_inference:=====================================================
INFO:hybrid_inference:Initializing Token Pruner...
INFO:hybrid_inference:Starting inference loop for 100 tokens...
`torch.nn.functional.scaled_dot_product_attention` does not support `output_attentions=True`. Falling back to eager attention. This warning can be removed using the argument `attn_implementation="eager"` when loading the model.
WARNING:token_pruning.token_pruner:Expected query length (Q) of 1 for scoring, but got 15. Using only the first query position.
ERROR:token_pruning.token_pruner:Error during index_select for layer 0: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 24, 64]), Value=torch.Size([1, 12, 24, 64]), Index=torch.Size([23])
ERROR:token_pruning.token_pruner:Error during index_select for layer 1: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 24, 64]), Value=torch.Size([1, 12, 24, 64]), Index=torch.Size([23])
ERROR:token_pruning.token_pruner:Error during index_select for layer 2: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 24, 64]), Value=torch.Size([1, 12, 24, 64]), Index=torch.Size([23])
ERROR:token_pruning.token_pruner:Error during index_select for layer 3: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 24, 64]), Value=torch.Size([1, 12, 24, 64]), Index=torch.Size([23])
ERROR:token_pruning.token_pruner:Error during index_select for layer 4: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 24, 64]), Value=torch.Size([1, 12, 24, 64]), Index=torch.Size([23])
ERROR:token_pruning.token_pruner:Error during index_select for layer 5: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 24, 64]), Value=torch.Size([1, 12, 24, 64]), Index=torch.Size([23])
ERROR:token_pruning.token_pruner:Error during index_select for layer 6: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 24, 64]), Value=torch.Size([1, 12, 24, 64]), Index=torch.Size([23])
ERROR:token_pruning.token_pruner:Error during index_select for layer 7: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 24, 64]), Value=torch.Size([1, 12, 24, 64]), Index=torch.Size([23])
ERROR:token_pruning.token_pruner:Error during index_select for layer 8: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 24, 64]), Value=torch.Size([1, 12, 24, 64]), Index=torch.Size([23])
ERROR:token_pruning.token_pruner:Error during index_select for layer 9: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 24, 64]), Value=torch.Size([1, 12, 24, 64]), Index=torch.Size([23])
ERROR:token_pruning.token_pruner:Error during index_select for layer 10: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 24, 64]), Value=torch.Size([1, 12, 24, 64]), Index=torch.Size([23])
ERROR:token_pruning.token_pruner:Error during index_select for layer 11: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 24, 64]), Value=torch.Size([1, 12, 24, 64]), Index=torch.Size([23])
INFO:token_pruning.token_pruner:Pruned 1 tokens. New seq len: 23
ERROR:token_pruning.token_pruner:Error during index_select for layer 0: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 25, 64]), Value=torch.Size([1, 12, 25, 64]), Index=torch.Size([19])
ERROR:token_pruning.token_pruner:Error during index_select for layer 1: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 25, 64]), Value=torch.Size([1, 12, 25, 64]), Index=torch.Size([19])
ERROR:token_pruning.token_pruner:Error during index_select for layer 2: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 25, 64]), Value=torch.Size([1, 12, 25, 64]), Index=torch.Size([19])
ERROR:token_pruning.token_pruner:Error during index_select for layer 3: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 25, 64]), Value=torch.Size([1, 12, 25, 64]), Index=torch.Size([19])
ERROR:token_pruning.token_pruner:Error during index_select for layer 4: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 25, 64]), Value=torch.Size([1, 12, 25, 64]), Index=torch.Size([19])
ERROR:token_pruning.token_pruner:Error during index_select for layer 5: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 25, 64]), Value=torch.Size([1, 12, 25, 64]), Index=torch.Size([19])
ERROR:token_pruning.token_pruner:Error during index_select for layer 6: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 25, 64]), Value=torch.Size([1, 12, 25, 64]), Index=torch.Size([19])
ERROR:token_pruning.token_pruner:Error during index_select for layer 7: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 25, 64]), Value=torch.Size([1, 12, 25, 64]), Index=torch.Size([19])
ERROR:token_pruning.token_pruner:Error during index_select for layer 8: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 25, 64]), Value=torch.Size([1, 12, 25, 64]), Index=torch.Size([19])
ERROR:token_pruning.token_pruner:Error during index_select for layer 9: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 25, 64]), Value=torch.Size([1, 12, 25, 64]), Index=torch.Size([19])
ERROR:token_pruning.token_pruner:Error during index_select for layer 10: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 25, 64]), Value=torch.Size([1, 12, 25, 64]), Index=torch.Size([19])
ERROR:token_pruning.token_pruner:Error during index_select for layer 11: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 25, 64]), Value=torch.Size([1, 12, 25, 64]), Index=torch.Size([19])
INFO:token_pruning.token_pruner:Pruned 6 tokens. New seq len: 19
ERROR:token_pruning.token_pruner:Error during index_select for layer 0: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 26, 64]), Value=torch.Size([1, 12, 26, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 1: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 26, 64]), Value=torch.Size([1, 12, 26, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 2: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 26, 64]), Value=torch.Size([1, 12, 26, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 3: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 26, 64]), Value=torch.Size([1, 12, 26, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 4: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 26, 64]), Value=torch.Size([1, 12, 26, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 5: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 26, 64]), Value=torch.Size([1, 12, 26, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 6: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 26, 64]), Value=torch.Size([1, 12, 26, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 7: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 26, 64]), Value=torch.Size([1, 12, 26, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 8: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 26, 64]), Value=torch.Size([1, 12, 26, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 9: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 26, 64]), Value=torch.Size([1, 12, 26, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 10: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 26, 64]), Value=torch.Size([1, 12, 26, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 11: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 26, 64]), Value=torch.Size([1, 12, 26, 64]), Index=torch.Size([24])
INFO:token_pruning.token_pruner:Pruned 2 tokens. New seq len: 24
ERROR:token_pruning.token_pruner:Error during index_select for layer 0: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 27, 64]), Value=torch.Size([1, 12, 27, 64]), Index=torch.Size([25])
ERROR:token_pruning.token_pruner:Error during index_select for layer 1: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 27, 64]), Value=torch.Size([1, 12, 27, 64]), Index=torch.Size([25])
ERROR:token_pruning.token_pruner:Error during index_select for layer 2: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 27, 64]), Value=torch.Size([1, 12, 27, 64]), Index=torch.Size([25])
ERROR:token_pruning.token_pruner:Error during index_select for layer 3: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 27, 64]), Value=torch.Size([1, 12, 27, 64]), Index=torch.Size([25])
ERROR:token_pruning.token_pruner:Error during index_select for layer 4: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 27, 64]), Value=torch.Size([1, 12, 27, 64]), Index=torch.Size([25])
ERROR:token_pruning.token_pruner:Error during index_select for layer 5: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 27, 64]), Value=torch.Size([1, 12, 27, 64]), Index=torch.Size([25])
ERROR:token_pruning.token_pruner:Error during index_select for layer 6: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 27, 64]), Value=torch.Size([1, 12, 27, 64]), Index=torch.Size([25])
ERROR:token_pruning.token_pruner:Error during index_select for layer 7: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 27, 64]), Value=torch.Size([1, 12, 27, 64]), Index=torch.Size([25])
ERROR:token_pruning.token_pruner:Error during index_select for layer 8: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 27, 64]), Value=torch.Size([1, 12, 27, 64]), Index=torch.Size([25])
ERROR:token_pruning.token_pruner:Error during index_select for layer 9: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 27, 64]), Value=torch.Size([1, 12, 27, 64]), Index=torch.Size([25])
ERROR:token_pruning.token_pruner:Error during index_select for layer 10: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 27, 64]), Value=torch.Size([1, 12, 27, 64]), Index=torch.Size([25])
ERROR:token_pruning.token_pruner:Error during index_select for layer 11: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 27, 64]), Value=torch.Size([1, 12, 27, 64]), Index=torch.Size([25])
INFO:token_pruning.token_pruner:Pruned 2 tokens. New seq len: 25
ERROR:token_pruning.token_pruner:Error during index_select for layer 0: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 28, 64]), Value=torch.Size([1, 12, 28, 64]), Index=torch.Size([27])
ERROR:token_pruning.token_pruner:Error during index_select for layer 1: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 28, 64]), Value=torch.Size([1, 12, 28, 64]), Index=torch.Size([27])
ERROR:token_pruning.token_pruner:Error during index_select for layer 2: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 28, 64]), Value=torch.Size([1, 12, 28, 64]), Index=torch.Size([27])
ERROR:token_pruning.token_pruner:Error during index_select for layer 3: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 28, 64]), Value=torch.Size([1, 12, 28, 64]), Index=torch.Size([27])
ERROR:token_pruning.token_pruner:Error during index_select for layer 4: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 28, 64]), Value=torch.Size([1, 12, 28, 64]), Index=torch.Size([27])
ERROR:token_pruning.token_pruner:Error during index_select for layer 5: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 28, 64]), Value=torch.Size([1, 12, 28, 64]), Index=torch.Size([27])
ERROR:token_pruning.token_pruner:Error during index_select for layer 6: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 28, 64]), Value=torch.Size([1, 12, 28, 64]), Index=torch.Size([27])
ERROR:token_pruning.token_pruner:Error during index_select for layer 7: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 28, 64]), Value=torch.Size([1, 12, 28, 64]), Index=torch.Size([27])
ERROR:token_pruning.token_pruner:Error during index_select for layer 8: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 28, 64]), Value=torch.Size([1, 12, 28, 64]), Index=torch.Size([27])
ERROR:token_pruning.token_pruner:Error during index_select for layer 9: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 28, 64]), Value=torch.Size([1, 12, 28, 64]), Index=torch.Size([27])
ERROR:token_pruning.token_pruner:Error during index_select for layer 10: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 28, 64]), Value=torch.Size([1, 12, 28, 64]), Index=torch.Size([27])
ERROR:token_pruning.token_pruner:Error during index_select for layer 11: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 28, 64]), Value=torch.Size([1, 12, 28, 64]), Index=torch.Size([27])
INFO:token_pruning.token_pruner:Pruned 1 tokens. New seq len: 27
ERROR:token_pruning.token_pruner:Error during index_select for layer 0: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 29, 64]), Value=torch.Size([1, 12, 29, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 1: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 29, 64]), Value=torch.Size([1, 12, 29, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 2: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 29, 64]), Value=torch.Size([1, 12, 29, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 3: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 29, 64]), Value=torch.Size([1, 12, 29, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 4: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 29, 64]), Value=torch.Size([1, 12, 29, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 5: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 29, 64]), Value=torch.Size([1, 12, 29, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 6: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 29, 64]), Value=torch.Size([1, 12, 29, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 7: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 29, 64]), Value=torch.Size([1, 12, 29, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 8: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 29, 64]), Value=torch.Size([1, 12, 29, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 9: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 29, 64]), Value=torch.Size([1, 12, 29, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 10: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 29, 64]), Value=torch.Size([1, 12, 29, 64]), Index=torch.Size([24])
ERROR:token_pruning.token_pruner:Error during index_select for layer 11: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 29, 64]), Value=torch.Size([1, 12, 29, 64]), Index=torch.Size([24])
INFO:token_pruning.token_pruner:Pruned 5 tokens. New seq len: 24
ERROR:token_pruning.token_pruner:Error during index_select for layer 0: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 30, 64]), Value=torch.Size([1, 12, 30, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 1: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 30, 64]), Value=torch.Size([1, 12, 30, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 2: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 30, 64]), Value=torch.Size([1, 12, 30, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 3: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 30, 64]), Value=torch.Size([1, 12, 30, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 4: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 30, 64]), Value=torch.Size([1, 12, 30, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 5: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 30, 64]), Value=torch.Size([1, 12, 30, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 6: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 30, 64]), Value=torch.Size([1, 12, 30, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 7: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 30, 64]), Value=torch.Size([1, 12, 30, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 8: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 30, 64]), Value=torch.Size([1, 12, 30, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 9: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 30, 64]), Value=torch.Size([1, 12, 30, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 10: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 30, 64]), Value=torch.Size([1, 12, 30, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 11: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 30, 64]), Value=torch.Size([1, 12, 30, 64]), Index=torch.Size([29])
INFO:token_pruning.token_pruner:Pruned 1 tokens. New seq len: 29
ERROR:token_pruning.token_pruner:Error during index_select for layer 0: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 31, 64]), Value=torch.Size([1, 12, 31, 64]), Index=torch.Size([26])
ERROR:token_pruning.token_pruner:Error during index_select for layer 1: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 31, 64]), Value=torch.Size([1, 12, 31, 64]), Index=torch.Size([26])
ERROR:token_pruning.token_pruner:Error during index_select for layer 2: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 31, 64]), Value=torch.Size([1, 12, 31, 64]), Index=torch.Size([26])
ERROR:token_pruning.token_pruner:Error during index_select for layer 3: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 31, 64]), Value=torch.Size([1, 12, 31, 64]), Index=torch.Size([26])
ERROR:token_pruning.token_pruner:Error during index_select for layer 4: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 31, 64]), Value=torch.Size([1, 12, 31, 64]), Index=torch.Size([26])
ERROR:token_pruning.token_pruner:Error during index_select for layer 5: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 31, 64]), Value=torch.Size([1, 12, 31, 64]), Index=torch.Size([26])
ERROR:token_pruning.token_pruner:Error during index_select for layer 6: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 31, 64]), Value=torch.Size([1, 12, 31, 64]), Index=torch.Size([26])
ERROR:token_pruning.token_pruner:Error during index_select for layer 7: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 31, 64]), Value=torch.Size([1, 12, 31, 64]), Index=torch.Size([26])
ERROR:token_pruning.token_pruner:Error during index_select for layer 8: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 31, 64]), Value=torch.Size([1, 12, 31, 64]), Index=torch.Size([26])
ERROR:token_pruning.token_pruner:Error during index_select for layer 9: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 31, 64]), Value=torch.Size([1, 12, 31, 64]), Index=torch.Size([26])
ERROR:token_pruning.token_pruner:Error during index_select for layer 10: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 31, 64]), Value=torch.Size([1, 12, 31, 64]), Index=torch.Size([26])
ERROR:token_pruning.token_pruner:Error during index_select for layer 11: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 31, 64]), Value=torch.Size([1, 12, 31, 64]), Index=torch.Size([26])
INFO:token_pruning.token_pruner:Pruned 5 tokens. New seq len: 26
ERROR:token_pruning.token_pruner:Error during index_select for layer 0: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 32, 64]), Value=torch.Size([1, 12, 32, 64]), Index=torch.Size([30])
ERROR:token_pruning.token_pruner:Error during index_select for layer 1: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 32, 64]), Value=torch.Size([1, 12, 32, 64]), Index=torch.Size([30])
ERROR:token_pruning.token_pruner:Error during index_select for layer 2: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 32, 64]), Value=torch.Size([1, 12, 32, 64]), Index=torch.Size([30])
ERROR:token_pruning.token_pruner:Error during index_select for layer 3: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 32, 64]), Value=torch.Size([1, 12, 32, 64]), Index=torch.Size([30])
ERROR:token_pruning.token_pruner:Error during index_select for layer 4: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 32, 64]), Value=torch.Size([1, 12, 32, 64]), Index=torch.Size([30])
ERROR:token_pruning.token_pruner:Error during index_select for layer 5: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 32, 64]), Value=torch.Size([1, 12, 32, 64]), Index=torch.Size([30])
ERROR:token_pruning.token_pruner:Error during index_select for layer 6: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 32, 64]), Value=torch.Size([1, 12, 32, 64]), Index=torch.Size([30])
ERROR:token_pruning.token_pruner:Error during index_select for layer 7: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 32, 64]), Value=torch.Size([1, 12, 32, 64]), Index=torch.Size([30])
ERROR:token_pruning.token_pruner:Error during index_select for layer 8: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 32, 64]), Value=torch.Size([1, 12, 32, 64]), Index=torch.Size([30])
ERROR:token_pruning.token_pruner:Error during index_select for layer 9: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 32, 64]), Value=torch.Size([1, 12, 32, 64]), Index=torch.Size([30])
ERROR:token_pruning.token_pruner:Error during index_select for layer 10: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 32, 64]), Value=torch.Size([1, 12, 32, 64]), Index=torch.Size([30])
ERROR:token_pruning.token_pruner:Error during index_select for layer 11: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 32, 64]), Value=torch.Size([1, 12, 32, 64]), Index=torch.Size([30])
INFO:token_pruning.token_pruner:Pruned 2 tokens. New seq len: 30
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -1: [1, -1]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -1: [1, -1]
ERROR:token_pruning.token_pruner:Error during index_select for layer 0: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 34, 64]), Value=torch.Size([1, 12, 34, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 1: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 34, 64]), Value=torch.Size([1, 12, 34, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 2: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 34, 64]), Value=torch.Size([1, 12, 34, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 3: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 34, 64]), Value=torch.Size([1, 12, 34, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 4: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 34, 64]), Value=torch.Size([1, 12, 34, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 5: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 34, 64]), Value=torch.Size([1, 12, 34, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 6: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 34, 64]), Value=torch.Size([1, 12, 34, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 7: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 34, 64]), Value=torch.Size([1, 12, 34, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 8: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 34, 64]), Value=torch.Size([1, 12, 34, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 9: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 34, 64]), Value=torch.Size([1, 12, 34, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 10: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 34, 64]), Value=torch.Size([1, 12, 34, 64]), Index=torch.Size([29])
ERROR:token_pruning.token_pruner:Error during index_select for layer 11: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 34, 64]), Value=torch.Size([1, 12, 34, 64]), Index=torch.Size([29])
INFO:token_pruning.token_pruner:Pruned 5 tokens. New seq len: 29
ERROR:token_pruning.token_pruner:Error during index_select for layer 0: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 35, 64]), Value=torch.Size([1, 12, 35, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 1: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 35, 64]), Value=torch.Size([1, 12, 35, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 2: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 35, 64]), Value=torch.Size([1, 12, 35, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 3: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 35, 64]), Value=torch.Size([1, 12, 35, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 4: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 35, 64]), Value=torch.Size([1, 12, 35, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 5: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 35, 64]), Value=torch.Size([1, 12, 35, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 6: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 35, 64]), Value=torch.Size([1, 12, 35, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 7: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 35, 64]), Value=torch.Size([1, 12, 35, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 8: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 35, 64]), Value=torch.Size([1, 12, 35, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 9: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 35, 64]), Value=torch.Size([1, 12, 35, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 10: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 35, 64]), Value=torch.Size([1, 12, 35, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 11: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 35, 64]), Value=torch.Size([1, 12, 35, 64]), Index=torch.Size([33])
INFO:token_pruning.token_pruner:Pruned 2 tokens. New seq len: 33
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -1: [1, -1]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -1: [1, -1]
ERROR:token_pruning.token_pruner:Error during index_select for layer 0: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 37, 64]), Value=torch.Size([1, 12, 37, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 1: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 37, 64]), Value=torch.Size([1, 12, 37, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 2: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 37, 64]), Value=torch.Size([1, 12, 37, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 3: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 37, 64]), Value=torch.Size([1, 12, 37, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 4: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 37, 64]), Value=torch.Size([1, 12, 37, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 5: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 37, 64]), Value=torch.Size([1, 12, 37, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 6: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 37, 64]), Value=torch.Size([1, 12, 37, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 7: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 37, 64]), Value=torch.Size([1, 12, 37, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 8: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 37, 64]), Value=torch.Size([1, 12, 37, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 9: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 37, 64]), Value=torch.Size([1, 12, 37, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 10: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 37, 64]), Value=torch.Size([1, 12, 37, 64]), Index=torch.Size([33])
ERROR:token_pruning.token_pruner:Error during index_select for layer 11: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 37, 64]), Value=torch.Size([1, 12, 37, 64]), Index=torch.Size([33])
INFO:token_pruning.token_pruner:Pruned 4 tokens. New seq len: 33
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -7: [1, -7]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -7: [1, -7]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -8: [1, -8]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -8: [1, -8]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -9: [1, -9]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -9: [1, -9]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -5: [1, -5]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -5: [1, -5]
ERROR:token_pruning.token_pruner:Error during index_select for layer 0: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 42, 64]), Value=torch.Size([1, 12, 42, 64]), Index=torch.Size([36])
ERROR:token_pruning.token_pruner:Error during index_select for layer 1: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 42, 64]), Value=torch.Size([1, 12, 42, 64]), Index=torch.Size([36])
ERROR:token_pruning.token_pruner:Error during index_select for layer 2: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 42, 64]), Value=torch.Size([1, 12, 42, 64]), Index=torch.Size([36])
ERROR:token_pruning.token_pruner:Error during index_select for layer 3: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 42, 64]), Value=torch.Size([1, 12, 42, 64]), Index=torch.Size([36])
ERROR:token_pruning.token_pruner:Error during index_select for layer 4: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 42, 64]), Value=torch.Size([1, 12, 42, 64]), Index=torch.Size([36])
ERROR:token_pruning.token_pruner:Error during index_select for layer 5: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 42, 64]), Value=torch.Size([1, 12, 42, 64]), Index=torch.Size([36])
ERROR:token_pruning.token_pruner:Error during index_select for layer 6: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 42, 64]), Value=torch.Size([1, 12, 42, 64]), Index=torch.Size([36])
ERROR:token_pruning.token_pruner:Error during index_select for layer 7: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 42, 64]), Value=torch.Size([1, 12, 42, 64]), Index=torch.Size([36])
ERROR:token_pruning.token_pruner:Error during index_select for layer 8: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 42, 64]), Value=torch.Size([1, 12, 42, 64]), Index=torch.Size([36])
ERROR:token_pruning.token_pruner:Error during index_select for layer 9: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 42, 64]), Value=torch.Size([1, 12, 42, 64]), Index=torch.Size([36])
ERROR:token_pruning.token_pruner:Error during index_select for layer 10: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 42, 64]), Value=torch.Size([1, 12, 42, 64]), Index=torch.Size([36])
ERROR:token_pruning.token_pruner:Error during index_select for layer 11: 'TokenPruner' object has no attribute 'kv_cache_dim'
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 311, in prune_state
    pruned_keys = torch.index_select(layer_keys, dim=self.kv_cache_dim, index=keep_indices_tensor)
                                                     ^^^^^^^^^^^^^^^^^
AttributeError: 'TokenPruner' object has no attribute 'kv_cache_dim'
ERROR:token_pruning.token_pruner:  Shapes: Key=torch.Size([1, 12, 42, 64]), Value=torch.Size([1, 12, 42, 64]), Index=torch.Size([36])
INFO:token_pruning.token_pruner:Pruned 6 tokens. New seq len: 36
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -20: [1, -20]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -20: [1, -20]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -9: [1, -9]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -9: [1, -9]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -12: [1, -12]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -12: [1, -12]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -11: [1, -11]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -11: [1, -11]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -6: [1, -6]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -6: [1, -6]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -6: [1, -6]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -6: [1, -6]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -7: [1, -7]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -7: [1, -7]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -11: [1, -11]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -11: [1, -11]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -13: [1, -13]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -13: [1, -13]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -9: [1, -9]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -9: [1, -9]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -8: [1, -8]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -8: [1, -8]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -15: [1, -15]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -15: [1, -15]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -12: [1, -12]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -12: [1, -12]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -12: [1, -12]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -12: [1, -12]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -13: [1, -13]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -13: [1, -13]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -13: [1, -13]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -13: [1, -13]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -15: [1, -15]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -15: [1, -15]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -3: [1, -3]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -3: [1, -3]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -11: [1, -11]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -11: [1, -11]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -4: [1, -4]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -4: [1, -4]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -10: [1, -10]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -10: [1, -10]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -9: [1, -9]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -9: [1, -9]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -11: [1, -11]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -11: [1, -11]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -21: [1, -21]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -21: [1, -21]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -17: [1, -17]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -17: [1, -17]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -9: [1, -9]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -9: [1, -9]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -12: [1, -12]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -12: [1, -12]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -15: [1, -15]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -15: [1, -15]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -9: [1, -9]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -9: [1, -9]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -12: [1, -12]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -12: [1, -12]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -17: [1, -17]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -17: [1, -17]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -8: [1, -8]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -8: [1, -8]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -7: [1, -7]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -7: [1, -7]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -14: [1, -14]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -14: [1, -14]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -10: [1, -10]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -10: [1, -10]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -18: [1, -18]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -18: [1, -18]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -23: [1, -23]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -23: [1, -23]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -17: [1, -17]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -17: [1, -17]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -7: [1, -7]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -7: [1, -7]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -11: [1, -11]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -11: [1, -11]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -7: [1, -7]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -7: [1, -7]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -7: [1, -7]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -7: [1, -7]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -12: [1, -12]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -12: [1, -12]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -10: [1, -10]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -10: [1, -10]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -19: [1, -19]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -19: [1, -19]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -18: [1, -18]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -18: [1, -18]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -17: [1, -17]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -17: [1, -17]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -13: [1, -13]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -13: [1, -13]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -13: [1, -13]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -13: [1, -13]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -13: [1, -13]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -13: [1, -13]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -16: [1, -16]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -16: [1, -16]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -16: [1, -16]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -16: [1, -16]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -19: [1, -19]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -19: [1, -19]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -15: [1, -15]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -15: [1, -15]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -20: [1, -20]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -20: [1, -20]
ERROR:token_pruning.token_pruner:Error during state pruning: Trying to create tensor with negative dimension -7: [1, -7]
Traceback (most recent call last):
  File "/Users/kevinyu/Projects/llm-mobile/src/token_pruning/token_pruner.py", line 275, in prune_state
    new_mask = torch.zeros((batch_size, new_mask_len), dtype=torch.long, device=device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to create tensor with negative dimension -7: [1, -7]
